<!DOCTYPE html>
<html>
  <head>
    <title>What are noise variables in Structural Equation Model? – Kailash Budhathoki – Scientist, Amazon</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="Given a causal graph \(\mathcal{G}\)A causal graph is a directed acyclic graph that represents data-generating process that operates sequentially along its arrows. of variables \(X_1, \dotsc, X_n\),
a structural equation model (SEM) represents the data-generating process of each node \(X_j\) as a function \(f_j\) of its parents \(\mathrm{PA}_j\) in \(\mathcal{G}\), and unobserved noise \(N_j\), i.e.
\[X_j := f_j(\textrm{PA}_j, N_j),\]
where noise variables $N_1, \dotsc, N_n$ are statistically jointly independent. A toy causal graph alongside its SEM.  Each structural assignment represents the causal mechanism that generates child $X_j$ from its parents $\mathrm{PA}_j$. Here, we will explore two questions regarding unobserved noise variables:

" />
    <meta property="og:description" content="Given a causal graph \(\mathcal{G}\)A causal graph is a directed acyclic graph that represents data-generating process that operates sequentially along its arrows. of variables \(X_1, \dotsc, X_n\),
a structural equation model (SEM) represents the data-generating process of each node \(X_j\) as a function \(f_j\) of its parents \(\mathrm{PA}_j\) in \(\mathcal{G}\), and unobserved noise \(N_j\), i.e.
\[X_j := f_j(\textrm{PA}_j, N_j),\]
where noise variables $N_1, \dotsc, N_n$ are statistically jointly independent. A toy causal graph alongside its SEM.  Each structural assignment represents the causal mechanism that generates child $X_j$ from its parents $\mathrm{PA}_j$. Here, we will explore two questions regarding unobserved noise variables:

" />
    
    <meta name="author" content="Kailash Budhathoki" />

    
    <meta property="og:title" content="What are noise variables in Structural Equation Model?" />
    <meta property="twitter:title" content="What are noise variables in Structural Equation Model?" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="/tufte.css"/>
    <link rel="stylesheet" href="/index.scss"/>
    <link rel="alternate" type="application/rss+xml" title="Kailash Budhathoki - Scientist, Amazon" href="/feed.xml" />
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  </head>

  <body>
    <article>
      <h3><a href="../">&#8592; Kailash's Home Page</a></h3>

<h2>What are noise variables in Structural Equation Model?</h2>

<div class="date">&mdash; November  8, 2020</div>

<section> <p>Given a causal graph \(\mathcal{G}\)<label for="sn-causalgraph" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-causalgraph" class="margin-toggle" /><span class="sidenote">A causal graph is a directed acyclic graph that represents data-generating process that operates sequentially along its arrows.</span> of variables \(X_1, \dotsc, X_n\),
a structural equation model (SEM) represents the data-generating process of each node \(X_j\) as a function \(f_j\) of its parents \(\mathrm{PA}_j\) in \(\mathcal{G}\), and <strong>unobserved</strong> noise \(N_j\), i.e.
\[X_j := f_j(\textrm{PA}_j, N_j),\]
where noise variables $N_1, \dotsc, N_n$ are statistically jointly independent. <span class="marginnote">A toy causal graph alongside its SEM. <img src="/images/sem.png" alt="Toy SCM" /></span> Each structural assignment represents the <i>causal mechanism</i> that generates child $X_j$ from its parents $\mathrm{PA}_j$. Here, we will explore two questions regarding unobserved noise variables:</p>

<h3>What do noise variables represent in reality?</h3>

<p>The formal definition suggests that a noise variable $N_j$ in SEM represents factors that <em>only</em> influence the corresponding observed variable $X_j$—but not other noises or observed variables<label for="sn-pearl-noise" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-pearl-noise" class="margin-toggle" /><span class="sidenote">Pearl <a class="citation" href="#pearl:2012:sem">(Pearl, 2012)</a> writes, “they represent observed or unobserved background factors that the modeler decides to keep unexplained—that is, factors that influence but are not influenced by the other variables (called “endogenous”) in the model … The[y] <del>former</del> are shaped by physical reality (e.g., genetic factors, socioeconomic conditions)<del>, not by analysis</del>; they are treated as any other variable, though we often cannot measure their values precisely and must resign ourselves to merely acknowledging their existence and assessing qualitatively how they relate to other variables in the system.”</span>.  Moreover, as noise $N_j$ is unobserved, it also represents “phenomenon” due to which $X_j$ cannot be explained alone—deterministically—by the observed values of its parents $\textrm{pa}_j$. One example of such phenomenon is <a href="https://www.physics.umd.edu/courses/Phys276/Hill/Information/Notes/ErrorAnalysis.html">random error</a> that is always present in a measurement. It could also be other unmeasurable factors (e.g. mood) that influence $X_j$.</p>

<h3>Can we identify noise variables from data?</h3>

<p>In practice, the underlying SEM is seldom known. Instead, what we often have is a sample drawn from the joint distribution $P_{X_1, \dotsc, X_n}$. We then have to learn the SEM from the sample. This boils down to learning functions $f_j$ and unobserved noises $N_j$. Fortunately, learning the underlying functional relationship between variables is a well-studied problem with a wide range of solutions <a class="citation" href="#shwartz:2014:ml-theory-book">(Shalev-Shwartz &amp; Ben-David, 2014)</a>. Learning the unobserved noise, however, is a non-trivial learning problem for generic functions and noises.</p>

<p>To see this<label for="sn-learn-noise" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-learn-noise" class="margin-toggle" /><span class="sidenote">The difficulty in learning unobserved noises in SEM from data for generic choices of functions and noises is also explained well in <a href="#schölkopf:2019:causality-ml">Schölkopf (2019)</a><span style="display:none"><a class="citation" href="#schölkopf:2019:causality-ml">(Schölkopf, 2019)</a></span>, and the general idea is briefly mentioned in <a href="#peters:2017:book">Peters et al. (Chapter 2, 2017)</a><span style="display:none"><a class="citation" href="#peters:2017:book">(Peters et al., 2017)</a></span> when drawing the connection between SEM and the principle of independent mechanism.</span>, consider the bivariate causal graph $X \rightarrow Y$ induced by the SEM $Y := f(X, N)$,
where $N$ is statistically independent of $X$, i.e. $N \mathrel{\unicode{x2AEB}} X$. Suppose that noise $N$ attains values in the finite set $\mathcal{N} := \{1, \dotsc, \xi \}$.
For each value $n \in \mathcal{N}$ that $N$ takes, the assignment $Y := f(X, N)$ reduces to the
deterministic causal mechanism $Y := f(X, n)$. For a non-smooth function, for instance, $N$ may randomly select a function $f_n(X)$ for each value of $N$ from the set $\mathcal{F} := \{f(X, n) =: f_n(X) \mid n \in \mathcal{N}\}$.
Learning such SCM (with $\xi := |\mathcal{N}|$ functions) from finite data is difficult, specially as noise $N$ is <i>unobserved</i>.</p>

<p>This problem of learning SEMs from data for a given causal graph is also known as “SEM Identification Problem” <a class="citation" href="#spirtes:1998:linear-sem-identification">(Spirtes et al., 1998)</a>. Although SEM identification is infeasible for a generic class of SEMs as shown above, the problem becomes feasible with additional assumptions that restrict the class of SEMs. <a href="#tian:2009:linear-sem-identification">Tian (2009)</a><span style="display:none"><a class="citation" href="#tian:2009:linear-sem-identification">(Tian, 2009)</a></span>, for instance, studied identifiability criteria for a class of linear SEMs—also known as linear additive noise models (ANMs)—with the possibility of having correlated noise variables. For ANMs, a more general (but <strong>weaker</strong>) identification result is possible without restricting the class of functions.</p>

<p>Suppose that the causal graph $\mathcal{G}$ is induced by ANM. That is, the structural assignment of each node $X_j$ in $\mathcal{G}$ consists of an <em>additive</em> noise:
\[
    X_j := f_j(\mathrm{PA}_j) + N_j.
\]</p>

<p>Then, from a sample drawn from the joint distribution $P_{X_j, \mathrm{PA}_j}$, we can estimate $f_j$ using regression<label for="sn-regression" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-regression" class="margin-toggle" /><span class="sidenote">
A <strong>regression function</strong> $r:\mathcal{X} \rightarrow \mathcal{Y}$ (where $\mathcal{Y}$ is often $\mathbb{R}$) gives us the expected value of the response variable $Y$ given an instance $x$ of the regressor $X$, i.e. $r(x) = \mathbb{E}[Y \mid X=x]$. It may belong to some finite (e.g. set of straight lines) or infinite family $\mathcal{R} \ni r$. A regression model from any family $\mathcal{R}$ can always be written as 
\[
    Y = r(X) + \epsilon,
\]
where $\mathbb{E}[\epsilon] = 0$. This is because we can define $\epsilon = Y - r(X)$ s.t. $Y = Y + r(X) - r(X)$ $= r(X) + \epsilon$, and mean of the residual $\epsilon$ is 
<span style="display: inline-block; visibility:hidden">space </span>
\(\begin{align}
    \mathbb{E}[\epsilon] &amp;= \mathbb{E}[\mathbb{E}[\epsilon \mid X]]\\
                         &amp;= \mathbb{E}[\mathbb{E}[ Y - r(X) \mid X]]\\ 
                         &amp;= \mathbb{E}[\mathbb{E}[ Y  \mid X] - \mathbb{E}[r(X) \mid X]]\\
                         &amp;= \mathbb{E}[r(X) - r(X)]\\
                         &amp;= 0
    \end{align}\)
<!-- <span style="display: inline-block; visibility:hidden">space</span> -->
Above, we observe that $\mathbb{E}[\epsilon \mid X] = 0$. Thus, we have $\mathbb{E}[\epsilon \mid X] = \mathbb{E}[\epsilon]$. That is, residual $\epsilon$ and input $X$ are <strong>mean independent</strong>. Mean independence also implies uncorrelatedness, $\textrm{Cov}(\epsilon, X)=0$. Note that if $\epsilon$ has a non-zero mean then we can incorporate that into $r(X)$ as an additive constant.
</span>
 $\hat{f}_j(\textrm{pa}_j) = \mathbb{E}[X_j \mid \textrm{PA}_j=\textrm{pa}_j]$. The residual $\epsilon_Y = Y - \hat{f}_j(\textrm{PA}_j)$ then gives us the (possibly mean-shifted) noise variable that is <strong>uncorrelated</strong> to parents $\textrm{PA}_j$, i.e. $\mathit{Cov}(\epsilon, \textrm{PA}_j)=0$.</p>

<p>Note that zero correlation is a weaker condition than statistical independence. The latter implies the former, but not the other way around. In special cases (e.g. multivariate Gaussian distribution), however, mean independence implies statistical independence (see <a href="https://en.wikipedia.org/wiki/Normally_distributed_and_uncorrelated_does_not_imply_independent">here</a>). Therefore for a linear regression with joint Gaussian distribution we can recover the noise up to statistical independence.</p>

<p>We still have to learn the regression function from data. To this end, we optimise some “loss function”—that measures how well a function $f$ fits the data—over a class of functions $\mathcal{F}$. Although regression estimates of many well-known loss functions (e.g. $\ell_1$, $\ell_2$) converge to the conditional mean asymptotically as the sample size approches infinity, for a finite sample size, some loss functions yield optimal results than the others depending on the distribution of noise. Whereas $\ell_1$-loss function gives optimal result for a Laplace distributed noise, $\ell_2$ loss provides optimal result for a Gaussian noise<label for="sn-ml-estimation" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-ml-estimation" class="margin-toggle" /><span class="sidenote">The $\ell_1$-loss minimisation yields median for the parameter, whereas $\ell_1$-loss yields mean. Note that the maximum likelihood estimates of the parameters of a Gaussian distribution can be computed from the sample mean. For a Laplacian distribution, they can be computed using sample median. Therefore, $\ell_2$ loss function is appropriate for a Gaussian noise, whereas $\ell_1$ loss function is suited for a Laplacian noise.</span>. If the distribution of the unobserved noise is unknown (which is often the case), it is hard to tell which loss function will yield optimal result. A promising approach then is to use a regression procedure that minimises dependence between residuals and regressors based on a non-parametric test of indpendence <a class="citation" href="#mooij:2009:dependence-minimisation-regression">(Mooij et al., 2009)</a>. The non-convexity of the resulting optimisation problem, however, makes it difficult to solve; as such, we have to rely on variants of Newton’s method that are approximate and often time-consuming.</p>

<p>Lastly, as causal inference rests on assumptions, it is crucial to check our assumptions. In case of ANM, for instance, we can run a hypothesis test to check if the unobserved noise we recover from data is statistically independent of regressors.</p>

<h2 id="references">References</h2>

<ol class="bibliography"><li><span id="pearl:2012:sem">Pearl, J. (2012). <i>The Causal Foundations of Structural Equation Modeling</i>. Guilford Press, New York.</span></li>
<li><span id="shwartz:2014:ml-theory-book">Shalev-Shwartz, S., &amp; Ben-David, S. (2014). <i>Understanding Machine Learning: From Theory to Algorithms</i>. Cambridge University Press.</span></li>
<li><span id="schölkopf:2019:causality-ml">Schölkopf, B. (2019). <i>Causality for Machine Learning</i>.</span></li>
<li><span id="peters:2017:book">Peters, J., Janzing, D., &amp; Schölkopf, B. (2017). <i>Elements of Causal Inference - Foundations and Learning Algorithms</i>. The MIT Press.</span></li>
<li><span id="spirtes:1998:linear-sem-identification">Spirtes, P., Richardson, T., Meek, C., Scheines, R., &amp; Glymour, C. (1998). Using Path Diagrams as a Structural Equation Modeling Tool. <i>Sociological Methods &amp; Research</i>, <i>27</i>(2), 182–225.</span></li>
<li><span id="tian:2009:linear-sem-identification">Tian, J. (2009). Parameter Identification in a Class of Linear Structural Equation Models. <i>IJCAI 2009, Proceedings of the 21st International Joint Conference
               on Artificial Intelligence, Pasadena, California, USA, July 11-17,
               2009</i>, 1970–1975.</span></li>
<li><span id="mooij:2009:dependence-minimisation-regression">Mooij, J. M., Janzing, D., Peters, J., &amp; Schölkopf, B. (2009). Regression by dependence minimization and its application to causal inference in additive noise models. <i>Proceedings of the 26th International Conference on Machine Learning</i>, 745–752.</span></li></ol>
 </section>



<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'kbuki-blog';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


    </article>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          <!-- 



<a href="https://github.com/barryclark/jekyll-now"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/jekyllrb"><i class="svg-icon twitter"></i></a>


 -->
        </footer>
      </div>
    </div>

    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-11967712-5', 'auto');
		ga('send', 'pageview', {
		  'page': '/what-are-exogenous-variables-in-sem/',
		  'title': 'What are noise variables in Structural Equation Model?'
		});
	</script>
	<!-- End Google Analytics -->


  </body>
</html>
